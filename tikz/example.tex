\documentclass{article}
\usepackage{pgfplots}
\usepackage{filecontents}
\usepackage{tikz}
\usepackage{verbatim}
\pgfplotsset{compat=1.8}
\usepackage{pgfplotstable}

\begin{document}
%% this will generate gnuplot scripts, you have to run them to generate the data to be plotted.
\begin{tikzpicture}[domain=0:4]
  \draw[very thin,color=gray] (-0.1,-1.1) grid (3.9,3.9);
  \draw[->] (-0.2,0) -- (4.2,0) node[right] {$x$};
  \draw[->] (0,-1.2) -- (0,4.2) node[above] {$f(x)$};
  \draw[color=red] plot[id=x] function{x}
  node[right] {$f(x) =x$};
  \draw[color=blue] plot[id=sin] function{sin(x)}
  node[right] {$f(x) = \sin x$};
  \draw[color=orange] plot[id=exp] function{0.05*exp(x)}
  node[right] {$f(x) = \frac{1}{20} \mathrm e^x$};
\end{tikzpicture}


\newcommand{\scalefactor}{1}
\begin{figure}[t]
  \centering
  \begin{tikzpicture}[scale=\scalefactor, thick]
    % \draw[step=0.5cm, gray!50] (-4, -3) grid (4,3);

    \node (A) at (-2.2,-1.8){{\bf A}};
    \node (B) at (2.8,-1.8){{\bf B} = $y_{\bf p}$};

    \node[circle,draw,scale=0.3] (realA) at (2,-1.5) {}; % circle at end of line seg
    \node[circle,draw,scale=0.3] (realB) at (-2,-1.5) {}; % {} no label for circle
    \node[circle,draw,scale=0.3] (origin) at (0,0) {};    % just for ref
    \path[draw,very thick] (-2,-1.5) -- (2,-1.5);

    \path[draw, red] (-2, -1) -- (2,2.5);
    \node (cp) at (1, 1.9){${\bf c_p}$};

    %% \draw[dotted]
    %% (0,0) node {1st node}
    %% -- (1,1) node {2nd node}
    %% -- (0,2) node {3rd node}
    %% -- cycle;
    %% \node (x) at (0,0) {x};   % using reference for drawing
    %% \node (y) at (3,1) {y};
    %% \draw (x) -- (y);
    
    \path[draw,blue] (-2, 0) -- (2,1.5);
    \node (cq) at (1,0.8){${\bf c_q}$};

    \path[draw, dotted] (-3,2.5) -- (2,2.5);
    \path[draw, dotted] (-3,-1) -- (-2,-1);
    \path[ <->] (-3,-1) edge node[left]{$\delta$} (-3,2.5);

    \path[draw, dotted] (-2.5,0) -- (-2,0);
    \path[ <->] (-2.5,0) edge node[right]{$\Delta$} (-2.5,-1);

    \path[draw, dotted] (-2.5,1.5) -- (2,1.5);
    \path[<->] (-2.5,1.5) edge node[right, align=center]{\small decrease in \\ \small value of ${\bf y_p}$}(-2.5,2.5);

    \path[->, dashed, sloped] (-3.5,-3) edge node[above]{\small increasing objective}  (-3.5,3);

    \node (maxC) at (2.8,2.5) {${\bf c_{\bf p}}^T{y_{\bf p}}$};

    \node at (0,-2.5){\small Two assignments};
    \path[draw,->, dotted] (1.1,-2.4) -- (B);
    \path[draw,->, dotted] (-1.1,-2.35) -- (A);

  \end{tikzpicture}
  \caption{{\footnotesize An illustration of the margin-based
      amortization scheme showing the very simple case with only two
      competing assignments {\bf A} and {\bf B}.}}
  \label{fig:theorem-figure}

\end{figure}

\end{document}
